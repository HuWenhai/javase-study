TCP：使用Socket
UDP：使用DatagramSocket

### TCP

#### Socket

*创建Socket*

    Socket socket = new Socket("10.4.7.15", 9999);
或

    Socket socket = new Socket("github.com", 80);

*向Socket写入数据*

<pre>
OutputStream out = socket.getOutputStream();
out.write("Hello world!".getBytes());
out.flush();
out.close();
</pre>

*从Socket读取数据*

<pre>
InputStream in = socket.getInputStream();
int data = -1;
while ((data = in.read()) != -1) {
    //do something
}
in.close();
</pre>

*关闭Socket*

<pre>
socket.close();
</pre>

#### ServerSocket

*创建ServerSocket*

<pre>
ServerSocket serverSocket = new ServerSocket(9999);
</pre>

*监听Socket连接*

<pre>
boolean isStopped = true;
while (!isStopped) {
    Socket request = serverSocket.accept();
    //do something
    request.close();
}
</pre>

*关闭 ServerSocket*

<pre>
serverSocket.close();
</pre>

完整的例子：

<pre>
public class KnockKnockServer {

    public static void main(String[] args) {
        try {
            ServerSocket server = new ServerSocket(8888);
            Socket client = server.accept();
            PrintWriter out = new PrintWriter(client.getOutputStream(), true);
            BufferedReader in = new BufferedReader(new InputStreamReader(client.getInputStream()));
            String inputLine, outputLine;

            // Initiate conversation with client
            KnockKnockProtocol kkp = new KnockKnockProtocol();
            outputLine = kkp.processInput(null);
            out.println(outputLine);

            while ((inputLine = in.readLine()) != null) {
                outputLine = kkp.processInput(inputLine);
                out.println(outputLine);
                if (out.equals("Bye.")) {
                    break;
                }
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
</pre>

<pre>
public class KnockKnockClient {
    public static void main(String[] args) throws IOException {
        
        try (
            Socket kkSocket = new Socket("127.0.0.1", 8888);
            PrintWriter out = new PrintWriter(kkSocket.getOutputStream(), true);
            BufferedReader in = new BufferedReader(
                new InputStreamReader(kkSocket.getInputStream()));
        ) {
            BufferedReader stdIn =
                new BufferedReader(new InputStreamReader(System.in));
            String fromServer;
            String fromUser;

            while ((fromServer = in.readLine()) != null) {
                System.out.println("Server: " + fromServer);
                if (fromServer.equals("Bye.")) {
                    break;
                }

                fromUser = stdIn.readLine();
                if (fromUser != null) {
                    System.out.println("Client: " + fromUser);
                    out.println(fromUser);
                }
            }

        } catch (UnknownHostException e) {
            System.err.println("Don't know about host ");
            System.exit(1);
        } catch (IOException e) {
            System.err.println("Couldn't get I/O for the connection to ");
            System.exit(1);
        }
    }
}
</pre>

<pre>
public class KnockKnockProtocol {
    private static final int WAITING = 0;
    private static final int SENTKNOCKKNOCK = 1;
    private static final int SENTCLUE = 2;
    private static final int ANOTHER = 3;

    private static final int NUMJOKES = 5;

    private int state = WAITING;
    private int currentJoke = 0;

    private String[] clues = { "Turnip", "Little Old Lady", "Atch", "Who", "Who" };
    private String[] answers = { "Turnip the heat, it's cold in here!",
                                 "I didn't know you could yodel!",
                                 "Bless you!",
                                 "Is there an owl in here?",
                                 "Is there an echo in here?" };

    public String processInput(String theInput) {
        String theOutput = null;

        if (state == WAITING) {
            theOutput = "Knock! Knock!";
            state = SENTKNOCKKNOCK;
        } else if (state == SENTKNOCKKNOCK) {
            if (theInput.equalsIgnoreCase("Who's there?")) {
                theOutput = clues[currentJoke];
                state = SENTCLUE;
            } else {
                theOutput = "You're supposed to say \"Who's there?\"! " +
			    "Try again. Knock! Knock!";
            }
        } else if (state == SENTCLUE) {
            if (theInput.equalsIgnoreCase(clues[currentJoke] + " who?")) {
                theOutput = answers[currentJoke] + " Want another? (y/n)";
                state = ANOTHER;
            } else {
                theOutput = "You're supposed to say \"" + 
			    clues[currentJoke] + 
			    " who?\"" + 
			    "! Try again. Knock! Knock!";
                state = SENTKNOCKKNOCK;
            }
        } else if (state == ANOTHER) {
            if (theInput.equalsIgnoreCase("y")) {
                theOutput = "Knock! Knock!";
                if (currentJoke == (NUMJOKES - 1))
                    currentJoke = 0;
                else
                    currentJoke++;
                state = SENTKNOCKKNOCK;
            } else {
                theOutput = "Bye.";
                state = WAITING;
            }
        }
        return theOutput;
    }
}
</pre>

### UDP
TCP和UDP区别

<table>
    <tr>
        <th></th>
        <th>TCP</th>
        <th>UDP</th>
    </tr>
    <tr>
        <td>是否连接</td>
        <td>面向连接</td>
        <td>面向非连接</td>
    </tr>
    <tr>
        <td>传输可靠性</td>
        <td>可靠的</td>
        <td>不可靠的</td>
    </tr>
    <tr>
        <td>应用场合</td>
        <td>传输大量的数据</td>
        <td>少量数据</td>
    </tr>
    <tr>
        <td>速度</td>
        <td>慢</td>
        <td>快</td>
    </tr>
</table>
 
#### 发送数据

<pre>
DatagramSocket datagramSocket = new DatagramSocket();

byte[] buffer = "0123456789".getBytes();
InetAddress receiverAddress = InetAddress.getLocalHost();

DatagramPacket packet = new DatagramPacket(
        buffer, buffer.length, receiverAddress, 9999);
datagramSocket.send(packet);
</pre>

#### 接收数据

<pre>
DatagramSocket datagramSocket = new DatagramSocket(9999);

byte[] buffer = new byte[10];
DatagramPacket packet = new DatagramPacket(buffer, buffer.length);

datagramSocket.receive(packet);

System.out.println(new String(packet.getData()));
</pre>
 
### URL、URLConnection

<pre>
URL url = new URL("http://www.baidu.com");

URLConnection urlConnection = url.openConnection();
InputStream in = urlConnection.getInputStream();
int data = in.read();
while(data != -1){
    System.out.print((char) data);
    data = in.read();
}
in.close();
</pre>

#### HTTP Post
URLConnection默认使用GET请求，如果需要使用POST请求，需要使用<code>URLConnection.setDoOutput(true) </code>
<pre>
URLConnection.setDoOutput(true) 
</pre>

#### 本地文件

<pre>
URL url = new URL("file:/d:/1.txt");
</pre>

### JarURLConnection

<pre>
String urlString = "http://butterfly.jenkov.com/"
                 + "container/download/"
                 + "jenkov-butterfly-container-2.9.9-beta.jar";

URL jarUrl = new URL(urlString);
JarURLConnection connection = new JarURLConnection(jarUrl);

Manifest manifest = connection.getManifest();


JarFile jarFile = connection.getJarFile();

//do something with Jar file...

</pre>

### InetAddress
#### 创建InetAddress
<pre>
InetAddress inetAddress = InetAddress.getByName("www.baidu.com");
InetAddress address = InetAddress.getByName("10.4.7.232");
InetAddress localhost = InetAddress.getLocalHost();
</pre>